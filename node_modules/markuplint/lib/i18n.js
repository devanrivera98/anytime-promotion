"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.i18n = void 0;
const tslib_1 = require("tslib");
const os_locale_1 = tslib_1.__importDefault(require("os-locale"));
let cachedLocale = null;
async function getLocale() {
    if (!cachedLocale) {
        cachedLocale = await (0, os_locale_1.default)({ spawn: true });
    }
    return cachedLocale;
}
async function i18n(locale) {
    var _a, _b;
    locale = (_a = locale !== null && locale !== void 0 ? locale : (await getLocale())) !== null && _a !== void 0 ? _a : 'en';
    const langCode = (_b = locale.split('-')[0]) !== null && _b !== void 0 ? _b : locale;
    const loadLocaleSet = await Promise.resolve(`${`@markuplint/i18n/locales/${langCode}`}`).then(s => tslib_1.__importStar(require(s))).catch(() => null);
    const localeSet = loadLocaleSet !== null && loadLocaleSet !== void 0 ? loadLocaleSet : 
    // @ts-ignore
    (await Promise.resolve().then(() => tslib_1.__importStar(require('@markuplint/i18n/locales/en'))));
    return {
        ...localeSet,
        locale: loadLocaleSet ? langCode : 'en',
    };
}
exports.i18n = i18n;
