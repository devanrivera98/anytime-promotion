"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getImplicitRoleName = exports.getImplicitRole = void 0;
const get_implicit_role_1 = require("../specs/get-implicit-role");
const get_role_spec_1 = require("../specs/get-role-spec");
const resolve_namespace_1 = require("../utils/resolve-namespace");
function getImplicitRole(specs, 
// eslint-disable-next-line @typescript-eslint/prefer-readonly-parameter-types
el, version) {
    const implicitRole = getImplicitRoleName(el, version, specs);
    if (implicitRole === false) {
        // No Corresponding Role
        return {
            el,
            role: null,
        };
    }
    const { namespaceURI } = (0, resolve_namespace_1.resolveNamespace)(el.localName, el.namespaceURI);
    const spec = (0, get_role_spec_1.getRoleSpec)(specs, implicitRole, namespaceURI, version);
    if (!spec) {
        return {
            el,
            role: null,
            errorType: 'IMPLICIT_ROLE_NAMESPACE_ERROR',
        };
    }
    return {
        el,
        role: {
            ...spec,
            isImplicit: true,
        },
    };
}
exports.getImplicitRole = getImplicitRole;
function getImplicitRoleName(
// eslint-disable-next-line @typescript-eslint/prefer-readonly-parameter-types
el, version, specs) {
    return (0, get_implicit_role_1.getImplicitRole)(specs, el.localName, el.namespaceURI, version, el.matches.bind(el));
}
exports.getImplicitRoleName = getImplicitRoleName;
