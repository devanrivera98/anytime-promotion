"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ml_core_1 = require("@markuplint/ml-core");
const controlSelector = ["input:not([type='hidden' i])", 'select', 'textarea'].join(',');
exports.default = (0, ml_core_1.createRule)({
    defaultSeverity: 'warning',
    async verify({ document, report, t }) {
        await document.walkOn('Element', el => {
            if (el.localName !== 'label') {
                return;
            }
            if (el.children.length === 0 && !el.hasAttribute('for')) {
                report({
                    scope: el,
                    message: t('{0} should associate with {1}', t('The "{0*}" {1}', 'label', 'element'), t('a {0}', 'control')),
                });
            }
            const controls = el.querySelectorAll(controlSelector);
            const secondControl = controls[1];
            if (secondControl) {
                report({
                    scope: secondControl,
                    message: t('{0} associates only {1}', t('The "{0*}" {1}', 'label', 'element'), t('first {0}', 'control')),
                });
            }
        });
    },
});
