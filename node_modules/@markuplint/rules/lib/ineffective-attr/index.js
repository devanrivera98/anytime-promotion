"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ml_core_1 = require("@markuplint/ml-core");
const shared_1 = require("@markuplint/shared");
exports.default = (0, ml_core_1.createRule)({
    defaultSeverity: 'warning',
    async verify({ document, report, t }) {
        await document.walkOn('Attr', attr => {
            const attrSpec = (0, ml_core_1.getAttrSpecs)(attr.ownerElement, document.specs);
            if (!attrSpec) {
                return;
            }
            const name = attr.name;
            const spec = attrSpec.find(s => s.name === name);
            if (!spec) {
                return;
            }
            const ineffectiveConditions = (0, shared_1.toNoEmptyStringArrayFromStringOrArray)(spec.ineffective);
            if (ineffectiveConditions.some(selector => attr.ownerElement.matches(selector))) {
                report({
                    scope: attr,
                    message: t('{0} is {1:c}', t('the "{0*}" {1}', name, 'attribute'), 'ineffective') +
                        t('. ') +
                        t("It doesn't need {0}", t('the {0}', 'attribute')),
                });
            }
        });
    },
});
