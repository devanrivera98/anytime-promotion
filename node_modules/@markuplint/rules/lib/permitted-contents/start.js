"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.start = void 0;
const order_1 = require("./order");
const represent_transparent_nodes_1 = require("./represent-transparent-nodes");
const utils_1 = require("./utils");
/**
 * Check start
 *
 * @param contents
 * @param el
 * @param specs
 * @param options
 * @returns
 */
function start(contents, 
// eslint-disable-next-line @typescript-eslint/prefer-readonly-parameter-types
el, specs, options) {
    var _a;
    if (contents === false) {
        if (el.childNodes.length > 0) {
            return [
                {
                    type: 'NOTHING',
                    scope: el,
                    query: ':not(*)',
                    hint: {},
                },
            ];
        }
        return [
            {
                type: 'MATCHED',
                scope: el,
                query: '*',
                hint: {},
            },
        ];
    }
    if (contents === true) {
        // Allows all elements
        return [
            {
                type: 'MATCHED',
                scope: el,
                query: '*',
                hint: {},
            },
        ];
    }
    const { nodes, errors } = (0, represent_transparent_nodes_1.representTransparentNodes)((0, utils_1.getChildNodesWithoutWhitespaces)(el), specs, options);
    const result = (0, order_1.order)(contents, nodes, specs, options, 0);
    return [
        {
            type: result.type,
            scope: result.type === 'MISSING_NODE_REQUIRED' || result.type === 'MISSING_NODE_ONE_OR_MORE'
                ? el
                : (_a = result.unmatched[0]) !== null && _a !== void 0 ? _a : el,
            query: result.query,
            hint: result.hint,
        },
        ...errors.map(error => {
            var _a;
            return ({
                type: error.type,
                scope: (_a = error.unmatched[0]) !== null && _a !== void 0 ? _a : el,
                query: error.query,
                hint: error.hint,
            });
        }),
    ];
}
exports.start = start;
